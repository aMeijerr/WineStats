<div class="wrapper">
  <app-navbar (toggleChartType)="changeToggleValue($event)"></app-navbar>

  <section class="select-forms">
    <form [formGroup]="form">
      <mat-form-field>
        <mat-label for="country">Choose country: </mat-label>
        <mat-select
          [(ngModel)]="currentCountry"
          (ngModelChange)="onCountrySelect()"
          formControlName="country"
          id="country"
        >
          <mat-option value="">All countries</mat-option>
          <mat-option
            *ngFor="let country of countries | keyvalue"
            [value]="country.key"
          >
            {{ country.key }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div class="select-options">
        <mat-form-field *ngIf="selectedToggleValue === 'region'">
          <mat-label for="region">Choose region: </mat-label>
          <mat-select formControlName="region" id="region">
            <mat-option value="">All regions</mat-option>
            <mat-option *ngFor="let region of filteredRegions" [value]="region">
              {{ region }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="selectedToggleValue === 'kategori'">
          <mat-label for="region">Choose category: </mat-label>
          <mat-select formControlName="category" id="category">
            <mat-option value="">All categories</mat-option>
            <mat-option value="Vin">Wine</mat-option>
            <mat-option value="Sprit">Spirits</mat-option>
            <mat-option value="Ã–l, Cider och Blanddryck"
              >Beer & Cider</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>
      <p>Select year span:</p>
      <mat-slider min="2009" max="2021" step="1" showTickMarks discrete>
        <input
          [(ngModel)]="minYear"
          matSliderStartThumb
          formControlName="minYear"
        />
        <input
          [(ngModel)]="maxYear"
          matSliderEndThumb
          formControlName="maxYear"
        />
      </mat-slider>
    </form>
  </section>

  <div class="outbox">
    <div class="container">
      <h2>Total sales by Country</h2>
      <app-charts [chartData]="chartData$ | async"></app-charts>
    </div>
    <div class="container">
      <h2>Top 10 producers by Category</h2>
      <app-toplist-chart
        [topProducerListData]="topProducerListData$ | async"
      ></app-toplist-chart>
    </div>
    <div class="container">
      <h2>Top 10 products</h2>
      <app-product-chart
        [topProductListData]="topProductListData$ | async"
      ></app-product-chart>
    </div>
  </div>
</div>
